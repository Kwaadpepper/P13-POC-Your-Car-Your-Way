<div class="container">
  <div class="row min-h-14 mb-3">
    <div class="col flex flex-col md:flex-row">
      <support-back-button backUrl=".." label="Support"></support-back-button>

      <h1 class="!m-4 text-ellipsis whitespace-nowrap overflow-hidden">
        Tickets
      </h1>
    </div>
  </div>
  @if (loading()) {
    <div class="row">
      <div class="col text-center">
        <p-progressSpinner></p-progressSpinner>
      </div>
    </div>
  }
  @if (loadingError()) {
    <div class="row">
      <div class="col">
        <p-message
          severity="error"
          text="Une erreur est survenue lors du chargement des tickets."
        ></p-message>
      </div>
    </div>
  }
  @if (issues().length < 1) {
    <div class="row">
      <div class="col">Aucune ticket trouvé.</div>
    </div>
  } @else {
    <div class="row">
      <div class="col">
        <p-listbox
          [options]="issues()"
          [optionLabel]="'title'"
          [filter]="true"
          [filterPlaceHolder]="'Rechercher…'"
          (onChange)="open($event.value)"
          [metaKeySelection]="false"
          class="block w-full md:max-h-screen overflow-y-auto"
          [scrollHeight]="'65vh'"
        >
          <ng-template let-item pTemplate="item">
            <div class="item">
              <p-avatar
                [label]="avatarLabel(item)"
                class="mr-2"
                shape="circle"
              ></p-avatar>
              <div class="content">
                <div class="row">
                  <span class="title">{{ item.subject }}</span>
                  <span class="updated">{{
                    item.updatedAt | date: "short"
                  }}</span>
                </div>
              </div>
            </div>
          </ng-template>
        </p-listbox>
      </div>
    </div>
  }
</div>
